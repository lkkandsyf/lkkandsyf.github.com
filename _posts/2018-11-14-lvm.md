---
layout: post
category:
tagline: "Supporting tagline"
tags: lvm
  -
title: 'Linux磁盘扩容'
---
当数据量越来越大的时候，磁盘空间需要进一步扩容，来应对的我们的需求。可通过LVM来管理磁盘和动态扩容。

LVM  Logical Volume Manage (逻辑卷管理),工作原理:

LVM在每个物理卷头部都维护了一个metadata，每个metadata中都包含了整个VG（volume group：卷组）的信息，包括每个VG的布局配置，PV（physical volume：物理卷）的编号，LV（logical volume：逻辑卷）的编号，以及每个PE（physical extends：物理扩展单元）到LE（logical extends：物理扩展单元）的映射关系。同一个VG中的每个PV头部的信息都是相同的，这样有利于故障时进行数据恢复。

LVM对上层文件系统提供LV层，隐藏了操作细节。对文件系统而言，对LV的操作与原先对partition的操作没有差别。当对LV进行写入操作的时候，LVM定位相应的LE，通过PV头部的映射表将数据写入到相应的PE上。LVM实现的关LVM最大的特点就是可以对`磁盘进行动态管理`。因为逻辑卷的大小是可以动态调整的，而且不会丢失现有的数据。我们如果新增加了硬盘，其也不会改变现有上层的逻辑卷。键在于PE和LE之间建立映射关系，不同的映射规则决定了不同的LVM存储模型。LVM支持多个PV 的stripe和mirror。

LVM最大的特点就是可以对磁盘进行动态管理，因为逻辑卷的大小是可以动态调整的，而且不会丢失现有的数据，如果我们增加了硬盘也不会改变现有的上层逻辑卷。

---


<!--more-->

## LVM 优缺点

 1. 优点

 + 文件系统可以跨多个磁盘，因此文件系统大小不会受物理磁盘的限制。

 + 可以在系统运行的状态下动态的扩展文件系统的大小。

 + 可以增加新的磁盘到LVM的存储池中。

 + 可以以镜像的方式冗余重要的数据到多个物理磁盘。

 + 可以方便的导出整个卷组到另外一台机器。


 2. 缺点

 + 在从卷组中移除一个磁盘的时候必须使用`reducevg`命令（这个命令要求root权限，并且不允许在快照卷组中使用）。

 + 当卷组中的一个磁盘损坏时，整个卷组都会受到影响。

 + 因为加入了额外的操作，存贮性能受到影响。


## 术语
 PV(physical volum)
